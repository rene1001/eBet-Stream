{% extends 'base.html' %}
{% block content %}
<div class="container py-4">
  <h1 class="mb-4 text-center text-warning"><i class="bi bi-gem"></i> Espace VIP</h1>
  <div class="row g-4">
    <!-- Solde KTAP et Statut VIP -->
    <div class="col-md-4">
      <div class="card shadow border-0 bg-dark text-light">
        <div class="card-body text-center">
          <h5 class="card-title">Solde KTAP</h5>
          <span class="display-4 fw-bold text-warning">{{ solde_ktap|default:0 }}</span>
          <div class="mt-3">
            <span class="badge bg-warning text-dark fs-6"><i class="bi bi-gem"></i> VIP depuis {{ user.vip_since|date:'d/m/Y' }}</span>
          </div>
        </div>
      </div>
    </div>
    <!-- Points de fidélité -->
    <div class="col-md-4">
      <div class="card shadow border-0">
        <div class="card-body text-center">
          <h5 class="card-title">Points de fidélité</h5>
          <span class="display-6 fw-bold text-primary">{{ points|default:0 }}</span>
          <div class="mt-2">
            <a href="{% url 'users:mes_points_fidelite' %}" class="btn btn-outline-primary btn-sm">Voir l'historique</a>
          </div>
        </div>
      </div>
    </div>
    <!-- Bonus récents -->
    <div class="col-md-4">
      <div class="card shadow border-0 bg-success text-light">
        <div class="card-body text-center">
          <h5 class="card-title">Bonus récents</h5>
          <ul class="list-unstyled mb-0">
            {% for b in bonus %}
              <li><span class="badge bg-light text-success me-2">{{ b.bonus_type|title }}</span> +{{ b.montant }} <small>({{ b.date|date:'d/m/Y' }})</small></li>
            {% empty %}
              <li><span class="text-light">Aucun bonus pour l'instant.</span></li>
            {% endfor %}
          </ul>
        </div>
      </div>
    </div>
  </div>
  <!-- Ventes en cours et Invitations -->
  <div class="row g-4 mt-4">
    <div class="col-md-6">
      <div class="card shadow border-0">
        <div class="card-body">
          <h5 class="card-title"><i class="bi bi-currency-exchange"></i> Ventes KTAP en cours</h5>
          <ul class="list-group list-group-flush">
            {% for vente in ventes %}
              <li class="list-group-item d-flex justify-content-between align-items-center">
                {{ vente.amount }} KTAP à <span class="fw-bold">{{ vente.price_per_token }}</span> / pièce
                <span class="badge bg-secondary">{{ vente.get_statut_display }}</span>
              </li>
            {% empty %}
              <li class="list-group-item">Aucune vente en cours.</li>
            {% endfor %}
          </ul>
          <a href="{% url 'users:vip_market' %}" class="btn btn-outline-secondary mt-3">Accéder au VIP Market</a>
        </div>
      </div>
    </div>
    <div class="col-md-6">
      <div class="card shadow border-0">
        <div class="card-body">
          <h5 class="card-title"><i class="bi bi-people"></i> Parrainage & Invitations</h5>
          <ul class="list-group list-group-flush">
            {% for filleul in invitations %}
              <li class="list-group-item">{{ filleul.username }} <span class="badge bg-info">Inscrit le {{ filleul.date_joined|date:'d/m/Y' }}</span></li>
            {% empty %}
              <li class="list-group-item">Aucune invitation pour l'instant.</li>
            {% endfor %}
          </ul>
        </div>
      </div>
    </div>
  </div>
  <!-- Liens rapides -->
  <div class="row mt-4">
    <div class="col text-center">
      <a href="{% url 'users:mes_evenements_vip' %}" class="btn btn-lg btn-outline-warning mx-2"><i class="bi bi-calendar-event"></i> Mes événements VIP</a>
      <a href="{% url 'users:mes_points_fidelite' %}" class="btn btn-lg btn-outline-primary mx-2"><i class="bi bi-trophy"></i> Mes points de fidélité</a>
    </div>
  </div>
</div>
{% endblock %} 